<!DOCTYPE html PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML>
<HEAD>
<TITLE>GMP/gmpLCG.c</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#1F00FF" ALINK="#FF0000" VLINK="#9900DD">
<A NAME="top"> </A>
<A NAME="file1"> </A>
<H1><a href="gmpLCG.c">gmpLCG.c</a></H1>

<PRE>
<I><FONT COLOR="#B22222">/**
   @file      gmpLCG.c
   @author    Mitch Richling &lt;http://www.mitchr.me/&gt;
   @Copyright Copyright 2005 by Mitch Richling.  All rights reserved.
   @brief     General implementation of an LCG with GMP.@EOL
   @Keywords  none
   @Std       C89

              General implementation of an LCG (Linear Congruential
              Generator) utilizing the simplest of algorithms, but
              making use of GMP to avoid overflow.

              GMP can be a powerful tool allowing the algorithm
              designer to focus on the algorithm in the early phases
              of algorithm design, and avoid the the vulgarities of
              machine arithmetic during this &quot;deep thought&quot; phase of
              development.  The designer is then free, after getting
              the algorithm to work, to focus on efficiency issues.

              Imagine for a moment that we had just discovered the
              LCG, and wanted to explore the algorithm.  Yes, several
              ways exist to implement specialized LCGs with 32-bit
              signed arithmetic; however, GMP allows us to use a
              straight forward algorithm right out of the gate.  We
              could test our new algorithm out without being forced to
              set down and think about how to implement the thing in
              32-bit arithmetic.  When we were done testing, we could
              then work on an optimal 32-bit implementation and use
              our GMP prototype to verify that our new and improved
              32-bit algorithm actually was correct.
*/</FONT></I>

#<B><FONT COLOR="#5F9EA0">include</FONT></B> <B><FONT COLOR="#BC8F8F">&lt;stdlib.h&gt;</FONT></B>             <I><FONT COLOR="#B22222">/* Standard Lib    ISOC  */</FONT></I>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <B><FONT COLOR="#BC8F8F">&lt;stdio.h&gt;</FONT></B>              <I><FONT COLOR="#B22222">/* I/O lib         ISOC  */</FONT></I>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <B><FONT COLOR="#BC8F8F">&lt;stdarg.h&gt;</FONT></B>             <I><FONT COLOR="#B22222">/* Variable args   ISOC  */</FONT></I>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <B><FONT COLOR="#BC8F8F">&lt;gmp.h&gt;</FONT></B>                <I><FONT COLOR="#B22222">/* GNU GMP Library       */</FONT></I>

<B><FONT COLOR="#228B22">int</FONT></B> <B><FONT COLOR="#0000FF">main</FONT></B> (<B><FONT COLOR="#228B22">void</FONT></B>) {
  <B><FONT COLOR="#228B22">int</FONT></B>               i;          <I><FONT COLOR="#B22222">/* Loop variable                 */</FONT></I>
  mpz_t             randNumMPZ; <I><FONT COLOR="#B22222">/* For intermediate computations */</FONT></I>
  <B><FONT COLOR="#228B22">unsigned</FONT></B> <B><FONT COLOR="#228B22">long</FONT></B> <B><FONT COLOR="#228B22">int</FONT></B> randNumINT; <I><FONT COLOR="#B22222">/* For final computation results */</FONT></I>

  <I><FONT COLOR="#B22222">/* Set the constants for the minimal standard LCG */</FONT></I>
  <B><FONT COLOR="#228B22">const</FONT></B> <B><FONT COLOR="#228B22">unsigned</FONT></B> <B><FONT COLOR="#228B22">int</FONT></B> M = 2147483647;
  <B><FONT COLOR="#228B22">const</FONT></B> <B><FONT COLOR="#228B22">unsigned</FONT></B> <B><FONT COLOR="#228B22">int</FONT></B> A = 16807;
  <B><FONT COLOR="#228B22">const</FONT></B> <B><FONT COLOR="#228B22">unsigned</FONT></B> <B><FONT COLOR="#228B22">int</FONT></B> B = 0;
  <B><FONT COLOR="#228B22">const</FONT></B> <B><FONT COLOR="#228B22">unsigned</FONT></B> <B><FONT COLOR="#228B22">int</FONT></B> S = 1;

  <I><FONT COLOR="#B22222">/* Set initial seed */</FONT></I>
  mpz_init_set_ui(randNumMPZ, S);

  printf( <B><FONT COLOR="#BC8F8F">&quot;10 numbers from LCG(%d, %d, %d, %d):\n&quot;</FONT></B>, M, A, B, S);
  <B><FONT COLOR="#A020F0">for</FONT></B> ( i = 0; i &lt; 10; i++ ) {
    <I><FONT COLOR="#B22222">/* Compute: randNumMPZ = (A*randNumMPZ+C)%M */</FONT></I>
    mpz_mul_si(randNumMPZ, randNumMPZ, A);
    mpz_add_ui(randNumMPZ, randNumMPZ, B);
    randNumINT = (<B><FONT COLOR="#228B22">unsigned</FONT></B> <B><FONT COLOR="#228B22">long</FONT></B> <B><FONT COLOR="#228B22">int</FONT></B>)mpz_mod_ui(randNumMPZ, randNumMPZ, M);
    printf( <B><FONT COLOR="#BC8F8F">&quot;%12lu\n&quot;</FONT></B>, randNumINT);
  } <I><FONT COLOR="#B22222">/* end for */</FONT></I>

  <B><FONT COLOR="#A020F0">return</FONT></B> 0;
} <I><FONT COLOR="#B22222">/* end func: main */</FONT></I>
</PRE>
<HR \/>
<ADDRESS>Generated by <A HREF="http://www.iki.fi/~mtr/genscript/">GNU Enscript 1.6.5.2</A>.</ADDRESS>
</BODY>
</HTML>
